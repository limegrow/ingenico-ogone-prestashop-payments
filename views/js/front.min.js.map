{"version":3,"sources":["front.js"],"names":["ingenico_payment_page_type","Ingenico","init","$","click","block","this","closest","find","first","is","slideUp","slideDown","css","data","src","prop","onload","setEnvironment","getBrowserData","elem","setCookie","browserColorDepth","window","screen","colorDepth","browserJavaEnabled","navigator","javaEnabled","browserLanguage","language","browserScreenHeight","height","browserScreenWidth","width","browserTimeZone","Date","getTimezoneOffset","name","value","days","d","setTime","getTime","document","cookie","toGMTString","inlineFailure","e","msg","aliasId","cardBrand","iframeUrl","ingenicoCcIFrame","ingenicoCcHelper","hide","html","on","event","stopPropagation","show","getElementById","setPaymentMethod","payment_method","ajax","ingenico_ajax_url","method","dataType","jQuery","ready","id","target","form","button","val","length","wrap","tos","setInterval","removeClass","addClass","url"],"mappings":"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","file":"front.min.js","sourcesContent":["/**\n * 2007-2021 Ingenico\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Academic Free License (AFL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http://opensource.org/licenses/afl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to contact@ingenico.com we can send you a copy immediately.\n *\n *  @author    Ingenico <contact@ingenico.com>\n *  @copyright 2007-2021 Ingenico\n *  @license   http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)\n */\n\"use strict\"\n/* global ingenico_payment_page_type */\n\nif ( typeof ingenico_payment_page_type === 'undefined' ) {\n    var ingenico_payment_page_type = null;\n}\n\nconst Ingenico = {\n\n    init: function () {\n        $('.ingenico-confirmation .payment-title').click(function() {\n            let block = $(this).closest('li').find('.payment-content').first();\n            if (block.is(':visible')) {\n                block.slideUp();\n            } else {\n                block.slideDown(400, function () {\n                    block.css('display', 'block');\n                });\n            }\n\n            // Load iframe\n            if (block.is('iframe') && !block.data('loaded')) {\n                let src = block.data('src');\n                block.prop('src', src);\n                block[0].onload = function() {\n                    block.data('loaded', 'true');\n                };\n            }\n        });\n    },\n\n    setEnvironment: function () {\n        const data = Ingenico.getBrowserData();\n        for (let elem in data) {\n            Ingenico.setCookie(elem, data[elem], 2);\n        }\n    },\n\n    getBrowserData: function () {\n        return {\n            'browserColorDepth': window.screen.colorDepth,\n            'browserJavaEnabled': navigator.javaEnabled(),\n            'browserLanguage': navigator.language,\n            'browserScreenHeight': window.screen.height,\n            'browserScreenWidth': window.screen.width,\n            'browserTimeZone': (new Date()).getTimezoneOffset()\n        };\n    },\n\n    setCookie: function(name, value, days) {\n        let d = new Date;\n        d.setTime(d.getTime() + 24*60*60*1000*days);\n        document.cookie = name + \"=\" + value + \";path=/;expires=\" + d.toGMTString();\n    },\n\n    inlineFailure: function (e, msg, aliasId, cardBrand, iframeUrl) {\n        let ingenicoCcIFrame = $('.ingenico-cc-form iframe#ingenico_iframe');\n        let ingenicoCcHelper = $('.ingenico-cc-form div.cc-helper-text');\n\n        ingenicoCcIFrame.hide();\n        ingenicoCcHelper.html(msg);\n\n        $('#ingenico-cc-iframe-retry').on('click', function(event) {\n            // Prevent PrestaShop collapsing step 4 in the checkout\n            event.stopPropagation();\n\n            ingenicoCcHelper.html('');\n\n            // Reload the iFrame\n            ingenicoCcIFrame.show();\n            document.getElementById('ingenico_iframe').src = iframeUrl;\n        });\n    },\n\n    /**\n     * Save Payment Method.\n     *\n     * @param payment_method\n     * @returns {*|jQuery}\n     */\n    setPaymentMethod: function (payment_method) {\n        return $.ajax(ingenico_ajax_url, {\n            'method': 'POST',\n            'data': {\n                method: 'set_payment_method',\n                payment_method: payment_method\n            },\n            'dataType': 'json'\n        });\n    }\n};\n\njQuery(document).ready(function ($) {\n    // Hide \"payment confirmation\" on the checkout page when cc form chosen\n    $(document).on( 'click', '.payment-options [name=\"payment-option\"]', function( e ) {\n        var id = $( e.target ).prop('id'),\n            form = $( '#pay-with-' + id + '-form' ),\n            button = $( '#payment-confirmation button' );\n\n        // Saved selected payment method\n        Ingenico.setPaymentMethod( form.find( '[name=\"payment_id\"]' ).first().val() );\n\n        if ( ingenico_payment_page_type === 'INLINE' ) {\n            // Tick the \"new card\" option if exists\n            form.find( '[name=\"alias\"]' ).find(':radio[value=new]').click();\n\n            button.show();\n            if ( form.find( '.ingenico_frame' ).length > 0 ) {\n                button.hide();\n            }\n        }\n    } );\n\n    // Toggle CCForm on alias selection\n    $(document).on( 'click', '.payment-options input[name=\"alias\"]', function( e ) {\n        if ( ingenico_payment_page_type === 'INLINE' ) {\n            var wrap = $( e.target ).closest( '.js-payment-option-form' ).find( '.one-click-wrap' ),\n                button = $( '#payment-confirmation button' );\n\n            if ( $(this).val() === 'new' ) {\n                wrap.show();\n                button.hide();\n            } else {\n                wrap.hide();\n                button.show();\n            }\n        }\n    });\n\n    if ( ingenico_payment_page_type === 'INLINE' ) {\n        var tos = $( '#conditions-to-approve input[type=\"checkbox\"]' );\n        if ( tos.length > 0 ) {\n            setInterval(function () {\n                if ( tos.is( ':checked' ) ) {\n                    //$( '.iframe-wrap' ).show();\n                    $( '.iframe-wrap' ).removeClass( 'locked-frame' );\n                } else {\n                    //$( '.iframe-wrap' ).hide();\n                    $( '.iframe-wrap' ).addClass( 'locked-frame' );\n                }\n            }, 500);\n        }\n    }\n});\n\n$(function() {\n    Ingenico.init();\n    Ingenico.setEnvironment();\n});\n\njQuery(document).ready(function ($) {\n    $(document).on('ingenico:inline:failure', 'body', function(e, msg, aliasId, cardBrand, url) {\n        Ingenico.inlineFailure(e, msg, aliasId, cardBrand, url);\n    });\n});"]}